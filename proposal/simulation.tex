\فصل{شبیه‌سازی}

در راستای ارزیابی انتها به انتها یک سیستم \متن‌لاتین{LoRa} یکی از راه‌های مورد استفاده،
بهره‌گیری از شبیه‌سازی است. شبیه‌سازی مدل‌سازی کامپیوتری یک راه‌حل مناسب برای بهبود تجربه
کاوش در کارایی سیستم و ارزیابی تکنیک‌های عملکردی آن در روش‌های مورد پیش‌بینی یا تصور است
\مرجع{Almuhaya2022}.

در این فصل قصد داریم مروری به روش‌های شبیه‌سازی برای یک سیستم انتها به انتها
\متن‌لاتین{LoRa} داشته باشیم و ادامه به بررسی شبیه‌سازی‌های صورت گرفته در این رساله می‌پردازیم.

\قسمت{ابزارهای شبیه‌سازی \متن‌لاتین{LoRaWAN}}

در حوزه \متن‌لاتین{LoRa} شبیه‌سازهای بسیار تخصصی و رایگان وجود دارند.
این شبیه‌سازهای \متن‌لاتین{LoRa} در این حوزه تحقیقاتی برای ارزیابی سناریوهای مختلف \متن‌لاتین{LoRa}
توسعه یافته و مورد استفاده قرار گرفته‌اند
\مرجع{Almuhaya2022}.

\زیرقسمت{شبیه‌ساز \متن‌لاتین{LoRaSIM}}

\متن‌لاتین{LoRaSIM} بر پایه \متن‌لاتین{SimPy} به عنوان یک شبیه‌ساز رویداد گسسته به وسیله‌ی پایتون برای
شبیه‌سازی، تحقیق و آنالیز گسترش‌پذیری و کارکرد تصادم در شبکه‌های \متن‌لاتین{LoRaWAN} توسعه پیدا کرده است.
این شبیه‌ساز رابط گرافیکی نداشته اما می‌تواند نمودارها و اشکال را برای نمایش با سایر ابزارها خروجی دهد.
مدل انتشار رادیویی بر پایه مدل‌های شناخته‌شده \متن‌لاتین{path-loss} در مسیرهای طولانی در \متن‌لاتین{LoRaSIM}
پیاده‌سازی شده است
\مرجع{Almuhaya2022}.

\زیرقسمت{شبیه‌ساز \متن‌لاتین{ns-3}}

\متن‌لاتین{ns-3} یک شبیه‌ساز شبکه رویداد گسسته است که در اواسط سال ۲۰۰۶
به زبان‌های \متن‌لاتین{C++} و \متن‌لاتین{python} ایجاد شده اما هنوز هم به شدت در حال توسعه است.
این شبیه‌ساز از گستره از پروتکل‌ها مانند \متن‌لاتین{WiFi}، \متن‌لاتین{LTE}، \متن‌لاتین{IEEE 802.15.4}،
\متن‌لاتین{Sigfox}، \متن‌لاتین{LoRa} و بسیاری شبکه‌های دیگر پشتیبانی می‌کند.
در \متن‌لاتین{ns-3} هم قابلیت شبیه‌سازی و هم قابلیت تقلید به واسطه \متن‌لاتین{socket}ها وجود دارد.
\متن‌لاتین{ns-3} می‌تواند با \متن‌لاتین{C++} خالص کار کرده یا برخی از ماژول‌های آن با \متن‌لاتین{python}
نوشته شوند.
در \متن‌لاتین{ns-3} می‌توان از \متن‌لاتین{pcap} برای جمع‌آوری بسته‌ها به منظور خطایابی استفاده کرد.
ماژول \متن‌لاتین{LoRaWAN} در \متن لاتین{ns-3} پیاده‌سازی شده است تا ابزاری قدرتمند را برای
شبیه‌سازی واقعی یک شبکه \متن‌لاتین{LoRaWAN} به جای شبیه‌سازی ساده شده لایه \متن‌لاتین{MAC} آن
فراهم آورد
\مرجع{Almuhaya2022}.

یک ماژول \متن‌لاتین{LoRaWAN} در \متن‌لاتین{ns-3} پیاده‌سازی و توسعه پیدا کرده است تا یک ابزار قدرتمند
برای شبیه‌سازی واقعی شبکه \متن‌لاتین{LoRaWAN} به جای شبیه‌سازی پروتکل ساده شده \متن‌لاتین{MAC} آن
فراهم آورد.
این ماژول به محققان و برنامه‌نویسان این فرصت را می‌دهد که بتوانند درک بهتری از رفتار لایه‌های \متن‌لاتین{MAC}
و فیزیکی در شبکه‌های \متن‌لاتین{LoRa} بدست آورند
\مرجع{Almuhaya2022}.

\زیرقسمت{شبیه‌ساز \متن‌لاتین{FLoRa}}

شبیه‌ساز \متن‌لاتین{FLoRa} برای ارزیابی کارایی شبکه \متن‌لاتین{LoRa} به همراه مکانیزم‌های \متن‌لاتین{ADR} طراحی شده است.
شبیه‌ساز \متن‌لاتین{FLoRa} بر پایه شبیه‌ساز شبکه‌ای \متن‌لاتین{OMNeT++} و از اجزای سیستم \متن‌لاتین{INET} استفاده می‌کند.
کد \متن‌لاتین{FLoRa} با \متن‌لاتین{C++} نوشته شده است و اجازه توسعه شبکه‌های \متن‌لاتین{LoRa} با پشتیبانی از ادغام
نودهای \متن‌لاتین{LoRa}، \متن‌لاتین{Gateway}ها و ماژول‌های سرور شبکه را فراهم می‌آورد
\مرجع{Almuhaya2022}.

برای شبیه‌سازی شبکه \متن‌لاتین{LoRa}، پارامترهای زیادی می‌بایست انتخاب شود.
از جمله این پارامترها می‌توان به زمان شبیه‌سازی، باز گرم کردن، فاکتور گسترش، توان ارسال برای هر یک از دستگاه‌های \متن‌لاتین{LoRa}،
تنظیمات شبکه \متن‌لاتین{backhaul} و لینک‌ها اشاره کرد
\مرجع{Almuhaya2022}.

\زیرقسمت{شبیه‌ساز \متن‌لاتین{CupCarbon}}

شبیه‌ساز \متن‌لاتین{Carbon} یک شبیه‌ساز رو به رشد در حوزه شبیه‌سازی شهر هوشمند و شبکه‌های سنسور بی‌سیم اینترنت اشیا است.
هدف آن طراحی، تجسم، عیب‌یابی و صحت‌سنجی الگوریتم‌های توزیع‌شده برای مشاهدات محیطی و جمع‌آوری داده است.
شبیه‌ساز \متن‌لاتین{CupCarbon} از دو محیط شبیه‌سازی برای طراحی سناریوهای متحرک و شبیه‌سازی رویداد گسسته پشتیبانی می‌کند.
شبکه‌ها می‌توانند به واسطه رابط کاربری گرافیکی ارگونومیک و کاربرپسند \متن‌لاتین{CupCarbon} شبیه‌سازی شوند و حسگرها می‌توانند
به راحتی بر روی نقشه‌های برگرفته از \متن‌لاتین{OpenStreetMap} جایگذاری شوند.
\متن‌لاتین{CupCarbon} از محاسبه توان مصرفی پشتیبانی کرده و می‌تواند آن را به عنوان تابعی از زمان شبیه‌سازی نمایش دهد.
این عملکردها اجازه می‌دهد ساختار شبکه شفاف شده و پیاده‌سازی واقعی پیش از استفرار واقعی صورت بپذیرد.
\متن‌لاتین{CupCarbon} از محیط‌های شبیه‌سازی چند عامل پشتیبانی کرده و اجازه می‌دهد در ضمن صورت پذیرفتن شبیه‌سازی رویدادها و
تنظیمات دنبال شوند.
این شبیه‌ساز اجازه تولید محیط‌های سه بعدی شامل ساختمان‌ها و طبقات را می‌دهد
\مرجع{Almuhaya2022}.

\زیرقسمت{شبیه‌ساز \متن‌لاتین{PhySimulator}}

شبیه‌ساز \متن‌لاتین{PhySimulator} به عنوان ارزیاب لایه پیوند داده \متن‌لاتین{LoRa} استفاده می‌شود.
\متن‌لاتین{PhySimulator} در \متن‌لاتین{MATLAB} نوشته شده است.
این شبیه‌ساز نشان داده است که با وجود اینکه از تئوری فاکتورهای گسترش مختلف می‌توانند عمود بریکدیگر در نظر گرفته شوند
اما یکی از مسائل واقعی در شبکه‌های \متن‌لاتین{LoRa} تداخل بین فاکتورهای گسترش مختلف است
\مرجع{Almuhaya2022}.

\زیرقسمت{جمع‌بندی}

تمام این شبیه‌سازها رویداد گسسته بوده، از پروتکل \متن‌لاتین{LoRaWAN} پشتیبانی می‌کنند و می‌توانند شبکه را در قالب
دنباله‌ای از رویدادهای گسسته در فضای زمان مدل کنند.
تمامی این شبیه‌ساز از زبان‌های برنامه‌نویسی شناخته شده استفاده می‌کنند که اجازه می‌دهد در صورت لزوم به سرعت بتوان
ماژول‌هایی را به عنوان افزونه در جهت گسترش توانایی‌های شبیه‌ساز پیاده‌سازی کرد
\مرجع{Almuhaya2022}.

به صورت خلاصه \متن‌لاتین{CupCarbon} با زبان \متن‌لاتین{Java}، \متن‌لاتین{FLoRa} با زبان \متن‌لاتین{C++}،
\متن‌لاتین{PhySimulator} با \متن‌لاتین{MATLAB}، \متن‌لاتین{LoRaSim} با زبان \متن‌لاتین{Python}
و \متن‌لاتین{ns-3} با زبان‌های \متن‌لاتین{C++} و \متن‌لاتین{Python} پیاده‌سازی شده‌اند
\مرجع{Almuhaya2022}.

شبیه‌ساز \متن‌لاتین{CupCarbon} می‌تواند محیط‌های سه بعدی و دو بعدی را شبیه‌سازی کند.
شبیه‌سازهای \متن‌لاتین{FLoTa} به واسطه \متن‌لاتین{OMNet++} و \متن‌لاتین{NS-3} به واسطه
\متن‌لاتین{NetAnim} و \متن‌لاتین{PyViz} رابط‌های کاربری گرافیکی گسترده‌ای را برای ماژول‌های \متن‌لاتین{Python}
و \متن‌لاتین{C++} فراهم می‌آورند.
در حالی که شبیه‌سازهای \متن‌لاتین{LoRaSim} و \متن‌لاتین{PhySimulator} تنها توانایی کشیدن نمودار دارند
\مرجع{Almuhaya2022}.

از بین این شبیه‌سازها، \متن‌لاتین{LoRaSim}، \متن‌لاتین{NS-3} و \متن‌لاتین{FLoRa} متن باز هستند.
\متن‌لاتین{CupCarbon} برای کاربردهای آموزشی رایگان بوده و \متن‌لاتین{PHY Simulator} رایگان است.
شبیه‌سازهای متن‌ باز روی \متن‌لاتین{Github} قرار دارند. از بین این شبیه‌سازها \متن‌لاتین{NS-3}
جامعه بزرگتری داشته و تحقیقات بیشتری از آن استفاده کرده‌اند
\مرجع{Almuhaya2022}.

\قسمت{ارزیابی کارایی سرور شبکه و اپلیکیشن \متن‌لاتین{LoRaWAN}}

در این شبیه‌سازی قصد داریم تعداد زیادی بسته در شرایط متفاوت برای سرور شبکه و اپلیکیشن ارسال کرده و عملکرد آن‌ها را در این شرایط برای تاخیر و نرخ از دست دادن بسته‌ها ارزیابی کنیم.
سرور شبکه همانطور که در پژوهش \مرجع{Carvalho2018} اشاره شده بود، یکی از سنگین‌ترین محاسبات در پیاده‌سازی مرجع \متن‌لاتین{LoRaWAN} را برعهده دارد و این مورد به
اهمیت این شبیه‌سازی می‌افزاید.
برای این کار از پیاده‌سازی متن‌باز \متن‌لاتین{Chirpstack}\مرجع{chirpstack} به عنوان سرور شبکه (نسخه $3.5.15$) و اپلیکیشن (نسخه $3.17.4$) استفاده کرده و بسته‌هایی را با ساختار مورد انتظار
\متن‌لاتین{Chirpstack} شبیه‌سازی و ارسال می‌کنیم.
این پیاده‌سازی از سرور شبکه بسته‌ها را از \متن‌لاتین{Gateway} به وسیله‌ی پروتکل \متن‌لاتین{MQTT} دریافت می‌کند و در این شبیه‌سازی ما بسته‌هایی با ساختار \متن‌لاتین{Chirpstack}
را با پروتکل \متن‌لاتین{MQTT} ارسال می‌کنیم. برای سرور \متن‌لاتین{MQTT} از سرور متن‌باز \متن‌لاتین{NATS}\مرجع{nats} (نسخه $2.7.3$) استفاده کرده‌ایم.
در نسخه ۳ از پیاده‌سازی متن‌باز \متن‌لاتین{Chirpstack} برخلاف نسخه‌های پیشین برای ارتباط میان \متن‌لاتین{Gateway} و سرور شبکه از پروتکل کدگذاری \متن‌لاتین{ProtoBuf} استفاده شده است که یک پروتکل
کدگذاری مشابه با \متن‌لاتین{JSON} (که در پژوهش \مرجع{Carvalho2018} برای انتقال داده میان \متن‌لاتین{Gateway} و سرور شبکه استفاده می‌شد.) بوده اما برخلاف آن باینری است و سربار کمتری دارد.

تاخیر و نرخ از دریافت بسته‌ها به صورت انتها به انتها محاسبه می‌شود و از همین رو بسته‌های ارسالی دوباره به واسطه‌ی پروتکل \متن‌لاتین{MQTT} اما اینبار از سرور اپلکیشن
دریافت می‌شوند و به این ترتیب می‌توان نرخ دریافت بسته و تاخیر انتها به انتها را محاسبه کرد. این فرآیند شامل انتقال داده تا سرور شبکه، از آنجا تا سرور اپلکیشن و در نهایت
دریافت آن از سرور اپلیکیشن است. از سوی دیگر رمزگشایی بسته، بررسی یکپارچگی آن و \نقاط‌خ که در سرور شبکه و اپلیکیشن رخ می‌دهند در این فرآیند دیده می‌شوند.

برای رمزگشایی صحیح بسته و دریافت آن نیاز است
که شی در سامانه \متن‌لاتین{Chirpstack} ثبت شود. برای سادگی از فرآیند اتصال \متن‌لاتین{ABP} به جای \متن‌لاتین{OTAA} استفاده شد که در آن کلیدها از پیش
داخل شی قرار گرفته و ایستا هستند.

کیفیت سرویس مورد استفاده برای انتشار و اشتراک روی \متن‌لاتین{MQTT} مقدار ''۱`` است. الگوریتم نرخ‌داده تطبیق‌پذیر روی سرور شبکه غیرفعال است.
داده‌های اشیا در قالب پروتکل \متن‌لاتین{CBOR} شبیه‌سازی شده‌اند که البته زمان کدگذاری و کدگشایی آن در این شبیه‌سازی لحاظ نشده است.
تمامی ارتباط‌ها از \متن‌لاتین{Gateway} تا سرور شبکه، از سرور شبکه تا سرور اپلیکیشن و از سرور اپلیکیشن تا دریافت دوباره داده
بر روی بستر پشته پروتکلی \متن‌لاتین{TCP/IP} هستند.

با توجه به زمان‌های محاسبه شده در محک‌های اول و دوم که همه‌ی سرویس‌ها روی یک سرور پیاده‌سازی شده‌اند، اینطور به نظر می‌رسد که دقت زمانی در حد میلی‌ثانیه
برای این ارزیابی کفایت می‌کند، بنابراین می‌توان از \متن‌لاتین{NTP} برای یکسان‌سازی زمانی استفاده کرد که عدم قطعیت آن از مرتبه میلی‌ثانیه است \مرجع{Sherman2016}.

در تمامی محک‌ها، در صورتی که بسته‌ای از دست رفته باشد تنها برای محاسبه نرخ دریافت از آن استفاده شده است و در سایر محاسبات لحاظ نشده است.
برای اطمینان از نتایج، هر ارزیابی ۱۰ بار تکرار شده است و میانگین، بیشینه و کمینه این ارزیابی‌ها ارائه شده است. در هر محک، ۱۰۰۰ بسته توسط هر شی ارسال شده است.

\زیرقسمت{محک اول}

در این سناریو از یک ماشین مجازی با هشت پردازنده مجازی از پردازنده فیزیکی
\متن‌لاتین{AMD Ryzen Threadripper 1950X}
و ۱۶ گیگابایت حافظه استفاده شد.
در این شبیه‌سازی، یک \متن‌لاتین{Gateway} و یک شی شبیه‌سازی شده است. فاصله میان ارسال داده‌ها از ۱ ثانیه تا ۱ میلی‌ثانیه تغییر می‌کند.
در این محک تمامی اجزای شبیه‌سازی روی یک ماشین مجازی اجرا شده‌اند.

در این سناریو همانطور که در شکل \رجوع{شکل: نرخ از دست رفتن بسته در ارزیابی کارایی سرور شبکه و اپلیکیشن LoRaWAN --- محک اول}
دیده می‌شود بسته‌ای از دست نرفته است و با وجود افزایش زمان تاخیر همه بسته‌ها دریافت شده‌اند.

پارامتر تاخیر میانگین، با رسیدن به نرخ ارسال ۱۰۰ بسته در ثانیه (فاصله ارسال ۱ میلی‌ثانیه) افزایش پیدا می‌کند و
تقریبا به ۱۷ و نیم ثانیه می‌رسد (شکل \رجوع{شکل: تاخیر میانگین در ارزیابی کارایی سرور شبکه و اپلیکیشن LoRaWAN --- محک اول}).
یکی از پارامترهای تاثیر گذار در تجربه کاربران، ۹۰ درصد بالای تاخیر است.
فاصله زیاد این مقدار از تاخیر میانگین باعث می‌شود تا بسته‌هایی وجود داشته باشند که تاخیر بالایی را نسبت به سایر بسته‌ها تجربه می‌کنند.
۹۰ درصد بالای تاخیر برای نرخ ارسال ۱ و ۱۰ بسته بر ثانیه به تاخیر میانگین نزدیک است اما برای ارسال ۱۰۰ بسته در ثانیه فاصله زیادی (تقریبا دو برابر) تا تاخیر میانگین دارد که این امر
در شکل \رجوع{شکل: ۹۰٪ بالای تاخیر در ارزیابی کارایی سرور شبکه و اپلیکیشن LoRaWAN --- محک اول} دیده می‌شود.

\شروع{شکل}
\درج‌تصویر[width=\textwidth]{./simulation/s1/e1/drop.png}
\شرح{نرخ از دست رفتن بسته در ارزیابی کارایی سرور شبکه و اپلیکیشن \متن‌لاتین{LoRaWAN} --- محک اول}
\برچسب{شکل: نرخ از دست رفتن بسته در ارزیابی کارایی سرور شبکه و اپلیکیشن LoRaWAN --- محک اول}
\پایان{شکل}

\شروع{شکل}
\درج‌تصویر[width=\textwidth]{./simulation/s1/e1/latency.png}
\شرح{تاخیر میانگین در ارزیابی کارایی سرور شبکه و اپلکیشن \متن‌لاتین{LoRaWAN} --- محک اول}
\برچسب{شکل: تاخیر میانگین در ارزیابی کارایی سرور شبکه و اپلیکیشن LoRaWAN --- محک اول}
\پایان{شکل}

\شروع{شکل}
\درج‌تصویر[width=\textwidth]{./simulation/s1/e1/p90_latency.png}
\شرح{۹۰٪ بالای تاخیر در ارزیابی کارایی سرور و اپلیکیشن \متن‌لاتین{LoRaWAN} --- محک اول}
\برچسب{شکل: ۹۰٪ بالای تاخیر در ارزیابی کارایی سرور شبکه و اپلیکیشن LoRaWAN --- محک اول}
\پایان{شکل}

\شروع{شکل}
\درج‌تصویر[width=\textwidth]{./simulation/s1/e1/arch-e1.png}
\شرح{ساختار ارزیابی در ارزیابی کارایی سرور شبکه و اپلیکیشن \متن‌لاتین{LoRaWAN} --- محک اول}
\برچسب{شکل: ساختار ارزیابی در ارزیابی کارایی سرور شبکه و اپلیکیشن LoRaWAN --- محک اول}
\پایان{شکل}

\زیرقسمت{محک دوم}

همانطور که پیشتر هم اشاره شد یکی از ویژگی‌های برجسته شبکه‌های \متن‌لاتین{LoRaWAN} عدم وجود
همبستگی میان اشیا و \متن‌لاتین{Gateway}ها است. در این شبکه‌ها داده اشیا توسط هر \متن‌لاتین{Gateway}ای
که در ناحیه پوشش‌دهی باشد دریافت شده و برای سرور شبکه ارسال می‌شود.
در این سناریو قصد ارزیابی این مورد را داریم.
برای این سناریو تمامی اجزای شبیه‌سازی روی همین ماشین مجازی اجرا شده‌اند.

در این سناریو از یک ماشین محازی با هشت پردازنده مجازی از پردازنده فیزیکی
\متن‌لاتین{AMD Ryzen Threadripper 1950X}
و ۱۶ گیگابایت حافظه استفاده شد.
در این شبیه‌سازی سه \متن‌لاتین{Gateway} شبیه‌سازی شده است که داده‌ی یک شی یکسان را گزارش می‌کنند. فاصله میان ارسال داده‌ها از ۱ ثانیه تا ۱ میلی‌ثانیه تغییر می‌کند.

در این سناریو با وجود اینکه بسته‌های تکراری در سرور شبکه حذف می‌شوند اما لود حاصل از این بسته‌ها باعث شده است تا در نرخ ارسال ۱۰۰۰ بسته در ثانیه
در این محک نسبت به محک اول بسته‌های از دست رفته داشته باشیم که این امر در شکل \رجوع{شکل: نرخ از دست رفتن بسته در ارزیابی کارایی سرور شبکه و اپلیکیشن LoRaWAN --- محک دوم}
مشهود است.

در بحث تاخیر، این دو محک تاخیر میانگین و ۹۰٪ بالای تاخیر مشابهی دارند البته بازه تغییرات در هر آزمایش در محک دو مقداری بیشتر از محک اول است
که گویا بار بیشتر به خاطر پردازش بسته‌های بیشتر است. تاخیر میانگین و ۹۰٪ بالای تاخیر در محک دوم در شکل‌های \رجوع{شکل: تاخیر میانگین در ارزیابی کارایی سرور شبکه و اپلیکیشن LoRaWAN --- محک دوم}
و \رجوع{شکل: ۹۰٪ بالای تاخیر در ارزیابی کارایی سرور شبکه و اپلیکیشن LoRaWAN --- محک دوم}
ارائه شده است.

\شروع{شکل}
\درج‌تصویر[width=\textwidth]{./simulation/s1/e2/drop.png}
\شرح{نرخ از دست رفتن بسته در ارزیابی کارایی سرور شبکه و اپلیکیشن \متن‌لاتین{LoRaWAN} --- محک دوم}
\برچسب{شکل: نرخ از دست رفتن بسته در ارزیابی کارایی سرور شبکه و اپلیکیشن LoRaWAN --- محک دوم}
\پایان{شکل}

\شروع{شکل}
\درج‌تصویر[width=\textwidth]{./simulation/s1/e2/latency.png}
\شرح{تاخیر میانگین در ارزیابی کارایی سرور شبکه و اپلیکیشن \متن‌لاتین{LoRaWAN} --- محک دوم}
\برچسب{شکل: تاخیر میانگین در ارزیابی کارایی سرور شبکه و اپلیکیشن LoRaWAN --- محک دوم}
\پایان{شکل}

\شروع{شکل}
\درج‌تصویر[width=\textwidth]{./simulation/s1/e2/p90_latency.png}
\شرح{۹۰٪ بالای تاخیر در ارزیابی کارایی سرور شبکه و اپلیکیشن \متن‌لاتین{LoRaWAN} --- محک دوم}
\برچسب{شکل: ۹۰٪ بالای تاخیر در ارزیابی کارایی سرور شبکه و اپلیکیشن LoRaWAN --- محک دوم}
\پایان{شکل}

\شروع{شکل}
\درج‌تصویر[width=\textwidth]{./simulation/s1/e2/arch-e2.png}
\شرح{ساختار ارزیابی در ارزیابی کارایی سرور شبکه و اپلیکیشن \متن‌لاتین{LoRaWAN} --- محک دوم}
\برچسب{شکل: ساختار ارزیابی در ارزیابی کارایی سرور شبکه و اپلیکیشن LoRaWAN --- محک دوم}
\پایان{شکل}


\زیرقسمت{محک سوم}

همانطور که پیشتر هم بیان شد عموما \متن‌لاتین{Gateway}ها در محیط عملیاتی قرار دارند و با سرورهایی که سرور شبکه
و اپلیکیشن را اجرا می‌کنند، فاصله دارند. از این رو در این محک از دو ماشین مجازی مجزا استفاده کرده و تاثیر آن را ارزیابی می‌کنیم.
این ماشین‌های مجازی متفاوت به واسطه‌ی شبکه‌ی \متن‌لاتین{1G} اترنت با یکدیگر ارتباط برقرار می‌کنند.

در این سناریو از دو ماشین محازی با هشت پردازنده مجازی از پردازنده فیزیکی
\متن‌لاتین{AMD Ryzen Threadripper 1950X}
و ۱۶ گیگابایت حافظه استفاده شد.
این شبیه‌سازی ۱۰ بار تکرار شده
و یک \متن‌لاتین{Gateway} شبیه‌سازی شده است که داده‌ی یک شی را گزارش می‌کنند. فاصله میان ارسال داده‌ها از ۱ ثانیه تا ۱۰ میلی‌ثانیه تغییر می‌کند.
تعداد بسته‌های ارسالی ۱۰۰۰ بسته بوده است.

در این سناریو با وجود جدا شدن سرویس‌ها، اما تاخیر شبکه‌ی اترنت محسوس نبوده و اعداد تقریبا مشابه با محک اول هستند.
(\رجوع{شکل: تاخیر میانگین در ارزیابی کارایی سرور شبکه و اپلیکیشن LoRaWAN --- محک سوم} \رجوع{شکل: ۹۰٪ بالای تاخیر در ارزیابی کارایی سرور شبکه و اپلیکیشن LoRaWAN --- محک سوم})
از دست رفت بسته رخ نداده است و که این امر کاملا با محک اول هماهنگ است. (\رجوع{شکل: نرخ از دست رفتن بسته در ارزیابی کارایی سرور شبکه و اپلیکیشن LoRaWAN --- محک سوم})

\شروع{شکل}
\درج‌تصویر[width=\textwidth]{./simulation/s1/e3/drop.png}
\شرح{نرخ از دست رفتن بسته در ارزیابی کارایی سرور شبکه و اپلیکیشن \متن‌لاتین{LoRaWAN} --- محک سوم}
\برچسب{شکل: نرخ از دست رفتن بسته در ارزیابی کارایی سرور شبکه و اپلیکیشن LoRaWAN --- محک سوم}
\پایان{شکل}

\شروع{شکل}
\درج‌تصویر[width=\textwidth]{./simulation/s1/e3/latency.png}
\شرح{تاخیر میانگین در ارزیابی کارایی سرور شبکه و اپلیکیشن \متن‌لاتین{LoRaWAN} --- محک سوم}
\برچسب{شکل: تاخیر میانگین در ارزیابی کارایی سرور شبکه و اپلیکیشن LoRaWAN --- محک سوم}
\پایان{شکل}

\شروع{شکل}
\درج‌تصویر[width=\textwidth]{./simulation/s1/e3/p90_latency.png}
\شرح{۹۰٪ بالای تاخیر در ارزیابی کارایی سرور شبکه و اپلیکیشن \متن‌لاتین{LoRaWAN} --- محک سوم}
\برچسب{شکل: ۹۰٪ بالای تاخیر در ارزیابی کارایی سرور شبکه و اپلیکیشن LoRaWAN --- محک سوم}
\پایان{شکل}

%\شروع{شکل}
%\درج‌تصویر[width=\textwidth]{./simulation/s1/e2/arch-e2.png}
%\شرح{ساختار ارزیابی در شبیه‌سازی سرور شبکه در نرخ بالا بسته --- محک دوم}
%\برچسب{شکل: ساختار ارزیابی در شبیه‌سازی سرور شبکه در نرخ بالا بسته --- محک دوم}
%\پایان{شکل}

\زیرقسمت{محک چهارم}

یکی از کاربردهای شبکه‌های \متن‌لاتین{LoRa} استفاده آن در محیط‌هایی با چندین شی است و پژوهش‌های بسیاری به گسترش‌پذیری این شبکه‌ها پرداخته‌اند.
در این محک قصد داریم تعداد اشیا را افزایش داده و تاثیر آن را بر پارامترهای مورد ارزیابی‌مان یعنی تاخیر و نرخ دریافت بسته مشاهده کنیم.

در این محک تعداد ۱۰۰ شی شبیه‌سازی شده‌اند که نرخ داده‌های متفاوتی را ارسال می‌کنند. به نظر می‌رسد با افزایش تعداد اشیا نسبت به محک‌ اول تاخیر بیشتر شده و بسته‌های بیشتری
از دست رفته‌اند. همانطور که در شکل \رجوع{شکل: نرخ دریافت بسته در ارزیابی کارایی سرور شبکه و اپلیکیشن LoRaWAN --- محک چهارم} مشهود است با افزایش نرخ ارسال داده در اشیا
تعداد بسیار زیادی از بسته‌ها، از دست می‌روند.
از سوی دیگر تاخیر نیز نسبت به محک اول افزایش داشته و با افزایش نرخ ارسال به صورت چشم‌گیری افزایش پیدا می‌کند
(\رجوع{شکل: تاخیر میانگین در ارزیابی کارایی سرور شبکه و اپلیکیشن LoRaWAN --- محک چهارم} \رجوع{شکل: ۹۰٪ بالای تاخیر در ارزیابی کارایی سرور شبکه و اپلیکیشن LoRaWAN --- محک چهارم}).
این محک نشان می‌دهد با افزایش تعداد اشیا زمان پردازش برای هر شی بیشتر شده است چرا که فاصله زمانی ۵۰۰ میلی‌ثانیه هم برای پردازش کافی نبوده و باعث از دست رفت بسته و
افزایش تاخیر شده است. با توجه به اهمیت این موضوع در محک پنجم، به صورت مشخص به ارزیابی تاثیر افزایش تعداد اشیا با ثابت نگاه داشتن نرخ ارسال پرداخته شده است.

\شروع{شکل}
\درج‌تصویر[width=\textwidth]{./simulation/s1/e4/drop.png}
\شرح{نرخ دریافت بسته در ارزیابی کارایی سرور شبکه و اپلیکیشن \متن‌لاتین{LoRaWAN} --- محک چهارم}
\برچسب{شکل: نرخ دریافت بسته در ارزیابی کارایی سرور شبکه و اپلیکیشن LoRaWAN --- محک چهارم}
\پایان{شکل}

\شروع{شکل}
\درج‌تصویر[width=\textwidth]{./simulation/s1/e4/latency.png}
\شرح{تاخیر میانگین در ارزیابی کارایی سرور شبکه و اپلیکیشن \متن‌لاتین{LoRaWAN} --- محک چهارم}
\برچسب{شکل: تاخیر میانگین در ارزیابی کارایی سرور شبکه و اپلیکیشن LoRaWAN --- محک چهارم}
\پایان{شکل}

\شروع{شکل}
\درج‌تصویر[width=\textwidth]{./simulation/s1/e4/p90_latency.png}
\شرح{۹۰٪ بالای تاخیر در ارزیابی کارایی سرور شبکه و اپلیکیشن \متن‌لاتین{LoRaWAN} --- محک چهارم}
\برچسب{شکل: ۹۰٪ بالای تاخیر در ارزیابی کارایی سرور شبکه و اپلیکیشن LoRaWAN --- محک چهارم}
\پایان{شکل}


\زیرقسمت{محک پنجم}

در این محک قصد داریم با ثابت نگاه داشتن نرخ ارسال بر ۵۰۰ میلی‌ثانیه، تعداد اشیا را افزایش دهیم و تاثیر آن را بر نرخ از دست رفتن بسته‌ها و تاخیر آن‌ها ارزیابی کنیم.
همانطور که در نمودارهای \رجوع{شکل: تاخیر میانگین در ارزیابی کارایی سرور شبکه و اپلیکیشن LoRaWAN --- محک پنجم}
و \رجوع{شکل: ۹۰٪ بالای تاخیر در ارزیابی کارایی سرور شبکه و اپلیکیشن LoRaWAN --- محک پنجم} مشخص است با افزایش تعداد اشیا تاخیر افزایش پیدا می‌کند.
در ادامه این افزایش تاخیر، نرخ دریافت بسته‌ها کاهش پیدا می‌کند (\رجوع{شکل: نرخ دریافت بسته در ارزیابی کارایی سرور شبکه و اپلیکیشن LoRaWAN --- محک پنجم}).

\شروع{شکل}
\درج‌تصویر[width=\textwidth]{./simulation/s1/e5/drop.png}
\شرح{نرخ دریافت بسته در ارزیابی کارایی سرور شبکه و اپلیکیشن \متن‌لاتین{LoRaWAN} --- محک پنجم}
\برچسب{شکل: نرخ دریافت بسته در ارزیابی کارایی سرور شبکه و اپلیکیشن LoRaWAN --- محک پنجم}
\پایان{شکل}

\شروع{شکل}
\درج‌تصویر[width=\textwidth]{./simulation/s1/e5/latency.png}
\شرح{تاخیر میانگین در ارزیابی کارایی سرور شبکه و اپلیکیشن \متن‌لاتین{LoRaWAN} --- محک پنجم}
\برچسب{شکل: تاخیر میانگین در ارزیابی کارایی سرور شبکه و اپلیکیشن LoRaWAN --- محک پنجم}
\پایان{شکل}

\شروع{شکل}
\درج‌تصویر[width=\textwidth]{./simulation/s1/e5/p90_latency.png}
\شرح{۹۰٪ بالای تاخیر در ارزیابی کارایی سرور شبکه و اپلیکیشن \متن‌لاتین{LoRaWAN} --- محک پنجم}
\برچسب{شکل: ۹۰٪ بالای تاخیر در ارزیابی کارایی سرور شبکه و اپلیکیشن LoRaWAN --- محک پنجم}
\پایان{شکل}


\زیرقسمت{محک ششم}

در این محک قصد داریم با ثابت نگاه داشتن نرخ ارسال بر ۵۰۰ میلی‌ثانیه و تعداد ۱۰۰ شی، تعداد \متن‌لاتین{Gateway}ها را افزایش دهیم و تاثیر آن را بر نرخ از دست رفتن بسته‌ها و تاخیر آن‌ها ارزیابی کنیم.
با افزایش \متن‌لاتین{Gateway}ها اشیا را به صورت مساوی بین آن‌ها تقسیم می‌کنیم و هر شی تنها با یک \متن‌لاتین{Gateway} در ارتباط خواهد بود.
همانطور که در شکل \رجوع{شکل: نرخ دریافت بسته در ارزیابی کارایی سرور شبکه و اپلیکیشن LoRaWAN --- محک ششم} مشخص است
با افزایش تعداد \متن‌لاتین{Gateway}ها نرخ از دست رفت بسته‌ها به طور چشم‌گیری کاهش پیدا می‌کند، بنابراین افزایش تعداد \متن‌لاتین{Gateway}ها نه تنها
به افزایش پوشش شبکه و دریافت بهتر بسته‌ها در لایه فیزیکی کمک می‌کند بلکه باعث کاهش از دست رفت بسته‌ها در شبکه هسته نیز می‌شود.

\شروع{شکل}
\درج‌تصویر[width=\textwidth]{./simulation/s1/e6/drop.png}
\شرح{نرخ دریافت بسته در ارزیابی کارایی سرور شبکه و اپلیکیشن \متن‌لاتین{LoRaWAN} --- محک ششم}
\برچسب{شکل: نرخ دریافت بسته در ارزیابی کارایی سرور شبکه و اپلیکیشن LoRaWAN --- محک ششم}
\پایان{شکل}

\شروع{شکل}
\درج‌تصویر[width=\textwidth]{./simulation/s1/e6/latency.png}
\شرح{تاخیر میانگین در ارزیابی کارایی سرور شبکه و اپلیکیشن \متن‌لاتین{LoRaWAN} --- محک ششم}
\برچسب{شکل: تاخیر میانگین در ارزیابی کارایی سرور شبکه و اپلیکیشن LoRaWAN --- محک ششم}
\پایان{شکل}

\شروع{شکل}
\درج‌تصویر[width=\textwidth]{./simulation/s1/e6/p90_latency.png}
\شرح{۹۰٪ بالای تاخیر در ارزیابی کارایی سرور شبکه و اپلیکیشن \متن‌لاتین{LoRaWAN} --- محک ششم}
\برچسب{شکل: ۹۰٪ بالای تاخیر در ارزیابی کارایی سرور شبکه و اپلیکیشن LoRaWAN --- محک ششم}
\پایان{شکل}
